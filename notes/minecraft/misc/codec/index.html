<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.23" /><meta name="theme" content="VuePress Theme Plume 1.0.0-rc.154" /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'dark';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Codec","image":[""],"dateModified":"2025-05-25T11:00:54.000Z","author":[]}</script><meta property="og:url" content="https://qihuang02.cn/notes/minecraft/misc/codec/"><meta property="og:site_name" content="QiHuang02的笔记本"><meta property="og:title" content="Codec"><meta property="og:description" content="1 数据驱动的基石 在目前的Minecraft（1.13+）模组开发中，数据驱动已成为主流。无论是自定义生物群系、新的配方类型还是某些复杂的方块行为，我们都倾向于将配置信息存储在 JSON 文件中，而不是硬编码在Java代码里。这极大地提高了模组的灵活性和可配置性。 然而，如何安全、高效地在 JSON 数据和游戏内的 Java 对象之间进行转换呢？这正..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-05-25T11:00:54.000Z"><meta property="article:modified_time" content="2025-05-25T11:00:54.000Z"><link rel="icon" type="image/svg+xml" sizes="16*16" href="/favicon.svg"><link rel="icon" type="image/svg+xml" sizes="32*32" href="/favicon.svg"><link rel="shortcut icon" type="image/svg+xml" sizes="16*16" href="/favicon.svg"><link rel="shortcut icon" type="image/svg+xml" sizes="32*32" href="/favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"><link rel="preconnect" href="https://static.zeoseven.com" crossorigin=""><link rel="stylesheet" href="https://static.zeoseven.com/zsft/442/main/result.css"><title>Codec | QiHuang02的笔记本</title><meta name="description" content="1 数据驱动的基石 在目前的Minecraft（1.13+）模组开发中，数据驱动已成为主流。无论是自定义生物群系、新的配方类型还是某些复杂的方块行为，我们都倾向于将配置信息存储在 JSON 文件中，而不是硬编码在Java代码里。这极大地提高了模组的灵活性和可配置性。 然而，如何安全、高效地在 JSON 数据和游戏内的 Java 对象之间进行转换呢？这正..."><link rel="preload" href="/assets/style-DYhNJSfY.css" as="style"><link rel="stylesheet" href="/assets/style-DYhNJSfY.css"><link rel="modulepreload" href="/assets/app-08d28jb5.js"><link rel="modulepreload" href="/assets/index.html-DVTHzhyW.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-4371dc7a><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-20edf97f></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-20edf97f> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-4371dc7a data-v-88a14e7f><div class="vp-navbar" vp-navbar data-v-88a14e7f data-v-45654e03><div class="wrapper" data-v-45654e03><div class="container" data-v-45654e03><div class="title" data-v-45654e03><div class="vp-navbar-title has-sidebar" data-v-45654e03 data-v-e450e451><a class="vp-link link no-icon title" href="/" data-v-e450e451><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" style="" src="/favicon.svg" alt data-v-05d76c0b><!--]--><!--[--><img class="vp-image light logo" style="" src="/favicon.svg" alt data-v-05d76c0b><!--]--><!--]--><!--]--><span data-v-e450e451>QiHuang02的笔记本</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-45654e03><div class="content-body" data-v-45654e03><!--[--><!--]--><div class="vp-navbar-search search" data-v-45654e03><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索文档"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索文档</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><!--[--><!--]--><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-45654e03 data-v-50c23242><span id="main-nav-aria-label" class="visually-hidden" data-v-50c23242>Main Navigation</span><!--[--><!--[--><a class="vp-link link navbar-menu-link" href="/" tabindex="0" data-v-50c23242 data-v-87f45f56><!--[--><!----><span data-v-87f45f56>首页</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/" tabindex="0" data-v-50c23242 data-v-87f45f56><!--[--><!----><span data-v-87f45f56>博客</span><!----><!--]--><!----></a><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-50c23242 data-v-52dbf9fb><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-52dbf9fb><span class="text" data-v-52dbf9fb><!----><!----><span data-v-52dbf9fb>笔记</span><!----><span class="vpi-chevron-down text-icon" data-v-52dbf9fb></span></span></button><div class="menu" data-v-52dbf9fb><div class="vp-menu" data-v-52dbf9fb data-v-bd8dd529><div class="items" data-v-bd8dd529><!--[--><!--[--><div class="vp-menu-link" data-v-bd8dd529 data-v-f13651b4><a class="vp-link link" href="/notes/" data-v-f13651b4><!--[--><!----> 目录 <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-group" data-v-bd8dd529 data-v-9185edf7><p class="title" data-v-9185edf7><span class="vp-icon-img" aria-hidden data-v-9185edf7 data-v-cce347a5><img src="https://zh.minecraft.wiki/images/Wiki.png?21467" alt="" style="" data-v-cce347a5></span><span data-v-9185edf7>Minecraft</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-9185edf7 data-v-f13651b4><a class="vp-link link" href="/notes/minecraft/kubejs/" data-v-f13651b4><!--[--><span class="vp-icon-img" aria-hidden data-v-f13651b4 data-v-cce347a5><img src="https://kubejs.com/img/logo/48.png" alt="" style="" data-v-cce347a5></span> KubeJS <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-9185edf7 data-v-f13651b4><a class="vp-link link" href="/notes/minecraft/misc/" data-v-f13651b4><!--[--><!----> Minecraft小知识 <!----><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="vp-menu-group" data-v-bd8dd529 data-v-9185edf7><p class="title" data-v-9185edf7><!----><span data-v-9185edf7>Git</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-9185edf7 data-v-f13651b4><a class="vp-link link" href="/notes/git/git_command" data-v-f13651b4><!--[--><!----> 常用指令 <!----><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/Friends/" tabindex="0" data-v-50c23242 data-v-87f45f56><!--[--><!----><span data-v-87f45f56>联结</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="https://image.qihuang02.cn/" target="_blank" rel="noreferrer" tabindex="0" data-v-50c23242 data-v-87f45f56><!--[--><!----><span data-v-87f45f56>图床</span><!----><!--]--><span class="vpi-external-link"></span></a><!--]--><!--]--></nav><!--[--><!--]--><!----><div class="vp-navbar-appearance appearance" data-v-45654e03 data-v-4ad9bd9d><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-4ad9bd9d data-v-b44357c7 data-v-c4f677a5><span class="check" data-v-c4f677a5><span class="icon" data-v-c4f677a5><!--[--><span class="vpi-sun sun" data-v-b44357c7></span><span class="vpi-moon moon" data-v-b44357c7></span><!--]--></span></span></button></div><div class="vp-social-links vp-navbar-social-links social-links" data-v-45654e03 data-v-953b5f67 data-v-02b6a344><!--[--><a class="vp-social-link no-icon" href="https://github.com/QiHuang02" aria-label="github" target="_blank" rel="noopener" data-v-02b6a344 data-v-f40875ac><span class="vpi-social-github" /></a><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-45654e03 data-v-dfd7af96 data-v-52dbf9fb><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-52dbf9fb><span class="vpi-more-horizontal icon" data-v-52dbf9fb></span></button><div class="menu" data-v-52dbf9fb><div class="vp-menu" data-v-52dbf9fb data-v-bd8dd529><!----><!--[--><!--[--><!----><div class="group" data-v-dfd7af96><div class="item appearance" data-v-dfd7af96><p class="label" data-v-dfd7af96>外观</p><div class="appearance-action" data-v-dfd7af96><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-dfd7af96 data-v-b44357c7 data-v-c4f677a5><span class="check" data-v-c4f677a5><span class="icon" data-v-c4f677a5><!--[--><span class="vpi-sun sun" data-v-b44357c7></span><span class="vpi-moon moon" data-v-b44357c7></span><!--]--></span></span></button></div></div></div><div class="group" data-v-dfd7af96><div class="item social-links" data-v-dfd7af96><div class="vp-social-links social-links-list" data-v-dfd7af96 data-v-02b6a344><!--[--><a class="vp-social-link no-icon" href="https://github.com/QiHuang02" aria-label="github" target="_blank" rel="noopener" data-v-02b6a344 data-v-f40875ac><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-45654e03 data-v-1c5a24dd><span class="container" data-v-1c5a24dd><span class="top" data-v-1c5a24dd></span><span class="middle" data-v-1c5a24dd></span><span class="bottom" data-v-1c5a24dd></span></span></button></div></div></div></div><div class="divider" data-v-45654e03><div class="divider-line" data-v-45654e03></div></div></div><!----></header><div class="vp-local-nav reached-top" data-v-4371dc7a data-v-e5cb8ae1><button class="menu" aria-expanded="false" aria-controls="SidebarNav" data-v-e5cb8ae1><span class="vpi-align-left menu-icon" data-v-e5cb8ae1></span><span class="menu-text" data-v-e5cb8ae1>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-e5cb8ae1 data-v-e9e266fd><button data-v-e9e266fd>返回顶部</button><!----></div></div><aside class="vp-sidebar hide-scrollbar" vp-sidebar data-v-4371dc7a data-v-70a6c298><div class="curtain" data-v-70a6c298></div><nav id="SidebarNav" class="nav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-70a6c298><span id="sidebar-aria-label" class="visually-hidden" data-v-70a6c298> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-b337dcb5><section class="vp-sidebar-item sidebar-item level-0 has-active" data-v-b337dcb5 data-v-ccc23c70><div class="item" role="button" tabindex="0" data-v-ccc23c70><div class="indicator" data-v-ccc23c70></div><span class="vp-icon-img" aria-hidden data-v-ccc23c70 data-v-cce347a5><img src="https://zh.minecraft.wiki/images/Wiki.png?21467" alt="" style="" data-v-cce347a5></span><h2 class="text" data-v-ccc23c70><span data-v-ccc23c70>我的世界小知识</span><!----></h2><!----></div><div data-v-ccc23c70 data-v-ccc23c70><div class="items" data-v-ccc23c70><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-ccc23c70 data-v-ccc23c70><div class="item" data-v-ccc23c70><div class="indicator" data-v-ccc23c70></div><!----><a class="vp-link link link" href="/notes/minecraft/misc/" data-v-ccc23c70><!--[--><p class="text" data-v-ccc23c70><span data-v-ccc23c70>前言</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-ccc23c70 data-v-ccc23c70><div class="item" data-v-ccc23c70><div class="indicator" data-v-ccc23c70></div><!----><a class="vp-link link link" href="/notes/minecraft/misc/attribute/" data-v-ccc23c70><!--[--><p class="text" data-v-ccc23c70><span data-v-ccc23c70>Attribute</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-ccc23c70 data-v-ccc23c70><div class="item" data-v-ccc23c70><div class="indicator" data-v-ccc23c70></div><!----><a class="vp-link link link" href="/notes/minecraft/misc/block/" data-v-ccc23c70><!--[--><p class="text" data-v-ccc23c70><span data-v-ccc23c70>Block</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-ccc23c70 data-v-ccc23c70><div class="item" data-v-ccc23c70><div class="indicator" data-v-ccc23c70></div><!----><a class="vp-link link link" href="/notes/minecraft/misc/blockbench/" data-v-ccc23c70><!--[--><p class="text" data-v-ccc23c70><span data-v-ccc23c70>Blockbench</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-ccc23c70 data-v-ccc23c70><div class="item" data-v-ccc23c70><div class="indicator" data-v-ccc23c70></div><!----><a class="vp-link link link" href="/notes/minecraft/misc/codec/" data-v-ccc23c70><!--[--><p class="text" data-v-ccc23c70><span data-v-ccc23c70>Codec</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-ccc23c70 data-v-ccc23c70><div class="item" data-v-ccc23c70><div class="indicator" data-v-ccc23c70></div><!----><a class="vp-link link link" href="/notes/minecraft/misc/data_components/" data-v-ccc23c70><!--[--><p class="text" data-v-ccc23c70><span data-v-ccc23c70>DataComponents</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-ccc23c70 data-v-ccc23c70><div class="item" data-v-ccc23c70><div class="indicator" data-v-ccc23c70></div><!----><a class="vp-link link link" href="/notes/minecraft/misc/ingredient/" data-v-ccc23c70><!--[--><p class="text" data-v-ccc23c70><span data-v-ccc23c70>Ingredient</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-ccc23c70 data-v-ccc23c70><div class="item" data-v-ccc23c70><div class="indicator" data-v-ccc23c70></div><!----><a class="vp-link link link" href="/notes/minecraft/misc/item/" data-v-ccc23c70><!--[--><p class="text" data-v-ccc23c70><span data-v-ccc23c70>Item</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-ccc23c70 data-v-ccc23c70><div class="item" data-v-ccc23c70><div class="indicator" data-v-ccc23c70></div><!----><a class="vp-link link link" href="/notes/minecraft/misc/loottype/" data-v-ccc23c70><!--[--><p class="text" data-v-ccc23c70><span data-v-ccc23c70>LootType</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-ccc23c70 data-v-ccc23c70><div class="item" data-v-ccc23c70><div class="indicator" data-v-ccc23c70></div><!----><a class="vp-link link link" href="/notes/minecraft/misc/Resource%20location/" data-v-ccc23c70><!--[--><p class="text" data-v-ccc23c70><span data-v-ccc23c70>Resource location</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-ccc23c70 data-v-ccc23c70><div class="item" data-v-ccc23c70><div class="indicator" data-v-ccc23c70></div><!----><a class="vp-link link link" href="/notes/minecraft/misc/resource_pack/" data-v-ccc23c70><!--[--><p class="text" data-v-ccc23c70><span data-v-ccc23c70>Resource pack</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><!--]--><!--[--><!--]--></nav></aside><!--[--><div id="VPContent" vp-content class="vp-content has-sidebar" data-v-4371dc7a data-v-1a55845d><div class="vp-doc-container has-sidebar has-aside" data-v-1a55845d data-v-fc326dca><!--[--><!--]--><div class="container" data-v-fc326dca><div class="aside" vp-outline data-v-fc326dca><div class="aside-curtain" data-v-fc326dca></div><div class="aside-container" data-v-fc326dca><div class="aside-content" data-v-fc326dca><div class="vp-doc-aside" data-v-fc326dca data-v-0ed6f048><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-0ed6f048 data-v-e3d9d23d><div class="content" data-v-e3d9d23d><div class="outline-marker" data-v-e3d9d23d></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-e3d9d23d><span data-v-e3d9d23d>此页内容</span><span class="vpi-print icon" data-v-e3d9d23d></span></div><ul class="root" data-v-e3d9d23d data-v-d9403be7><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-0ed6f048></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-fc326dca><div class="content-container" data-v-fc326dca><!--[--><!--]--><main class="main" data-v-fc326dca><nav class="vp-breadcrumb" data-v-fc326dca data-v-e3ca9796><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-e3ca9796><!--[--><li property="itemListElement" typeof="ListItem" data-v-e3ca9796><a class="vp-link link breadcrumb" href="/" property="item" typeof="WebPage" data-v-e3ca9796><!--[-->首页<!--]--><!----></a><span class="vpi-chevron-right" data-v-e3ca9796></span><meta property="name" content="首页" data-v-e3ca9796><meta property="position" content="1" data-v-e3ca9796></li><li property="itemListElement" typeof="ListItem" data-v-e3ca9796><span class="vp-link breadcrumb" property="item" typeof="WebPage" data-v-e3ca9796><!--[-->我的世界小知识<!--]--><!----></span><span class="vpi-chevron-right" data-v-e3ca9796></span><meta property="name" content="我的世界小知识" data-v-e3ca9796><meta property="position" content="2" data-v-e3ca9796></li><li property="itemListElement" typeof="ListItem" data-v-e3ca9796><a class="vp-link link breadcrumb current" href="/notes/minecraft/misc/codec/" property="item" typeof="WebPage" data-v-e3ca9796><!--[-->Codec<!--]--><!----></a><!----><meta property="name" content="Codec" data-v-e3ca9796><meta property="position" content="3" data-v-e3ca9796></li><!--]--></ol></nav><!--[--><!--]--><!--[--><h1 class="vp-doc-title page-title" data-v-c55208e9>Codec <!----></h1><div class="vp-doc-meta" data-v-c55208e9><!--[--><!--]--><p class="reading-time" data-v-c55208e9><span class="vpi-books icon" data-v-c55208e9></span><span data-v-c55208e9>约 2930 字</span><span data-v-c55208e9>大约 10 分钟</span></p><!----><!--[--><!--]--><p class="create-time" data-v-c55208e9><span class="vpi-clock icon" data-v-c55208e9></span><span data-v-c55208e9>2025-05-25</span></p></div><!--]--><!--[--><!--]--><div class="_notes_minecraft_misc_codec_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-fc326dca><!--[--><!--]--><div data-v-fc326dca><nav class="table-of-contents"><ul><li><a aria-current="page" href="/notes/minecraft/misc/codec/#_1-数据驱动的基石" class="router-link-active router-link-exact-active">1 数据驱动的基石</a><ul><li><a aria-current="page" href="/notes/minecraft/misc/codec/#_1-1-codec-的核心概念" class="router-link-active router-link-exact-active">1.1 Codec 的核心概念</a></li><li><a aria-current="page" href="/notes/minecraft/misc/codec/#_1-2-工作流程" class="router-link-active router-link-exact-active">1.2 工作流程</a></li><li><a aria-current="page" href="/notes/minecraft/misc/codec/#_1-3-为什么我们要使用-codec" class="router-link-active router-link-exact-active">1.3 为什么我们要使用 Codec？</a></li></ul></li><li><a aria-current="page" href="/notes/minecraft/misc/codec/#_2-codec-工具包-关键类与接口" class="router-link-active router-link-exact-active">2 Codec 工具包：关键类与接口</a><ul><li><a aria-current="page" href="/notes/minecraft/misc/codec/#_2-1-codec-a-双向转换器" class="router-link-active router-link-exact-active">2.1 Codec&lt;A&gt;：双向转换器</a></li><li><a aria-current="page" href="/notes/minecraft/misc/codec/#_2-2-dynamicops-t-适配数据格式-jsonops-nbtops" class="router-link-active router-link-exact-active">2.2 DynamicOps&lt;T&gt;：适配数据格式 (JsonOps, NbtOps)</a></li><li><a aria-current="page" href="/notes/minecraft/misc/codec/#_2-3-dataresult-a-处理结果与错误" class="router-link-active router-link-exact-active">2.3 DataResult&lt;A&gt;：处理结果与错误</a></li></ul></li><li><a aria-current="page" href="/notes/minecraft/misc/codec/#_3-如何构建-codec" class="router-link-active router-link-exact-active">3 如何构建 Codec</a><ul><li><a aria-current="page" href="/notes/minecraft/misc/codec/#_3-1-基本类型的-codec-string-int-bool-等" class="router-link-active router-link-exact-active">3.1 基本类型的 Codec (String, Int, Bool 等)</a></li><li><a aria-current="page" href="/notes/minecraft/misc/codec/#_3-2-使用-recordcodecbuilder-定义复杂数据" class="router-link-active router-link-exact-active">3.2 使用 RecordCodecBuilder 定义复杂数据</a></li><li><a aria-current="page" href="/notes/minecraft/misc/codec/#_3-3-转换与组合-codec" class="router-link-active router-link-exact-active">3.3 转换与组合 Codec</a></li></ul></li><li><a aria-current="page" href="/notes/minecraft/misc/codec/#_4-codec-在minecraft-neoforge、fabric-生态中的应用" class="router-link-active router-link-exact-active">4 Codec 在Minecraft （Neoforge、Fabric） 生态中的应用</a></li></ul></nav><h2 id="_1-数据驱动的基石" tabindex="-1"><a class="header-anchor" href="#_1-数据驱动的基石"><span>1 数据驱动的基石</span></a></h2><p>在目前的Minecraft（1.13+）模组开发中，数据驱动已成为主流。无论是自定义生物群系、新的配方类型还是某些复杂的方块行为，我们都倾向于将配置信息存储在 JSON 文件中，而不是硬编码在Java代码里。这极大地提高了模组的灵活性和可配置性。</p><p>然而，如何安全、高效地在 JSON 数据和游戏内的 Java 对象之间进行转换呢？这正是 Codec 发挥作用的地方。本文将简单地探讨 Codec 的概念、用途和优势，<s>并结合我的 PortalTransform 模组中的代码进行实例分析</s>。所以有一些不完全正确的地方请指出。</p><h3 id="_1-1-codec-的核心概念" tabindex="-1"><a class="header-anchor" href="#_1-1-codec-的核心概念"><span>1.1 Codec 的核心概念</span></a></h3><p>Codec（编解码器）这个词在百度百科中的解释是一个能够对一个信号或者一个数据流进行变换的设备或者程序。而我的世界中的 Codec 指的是一个由Mojang开发并深度集成到Minecraft中的双向数据转换框架。</p><p>你可以将其简单的理解为一个高度智能化的“翻译官”，它的职责是在两种完全不同的“语言”之间进行精确翻译：</p><ul><li>语言A： 游戏内存中的 <code>Java 对象 (Object)</code>。这是程序逻辑可以直接理解和操作的结构。</li><li>语言B： 用于存储和传输的<code>数据格式 (Data Format)</code>，通常是 <code>JSON</code> 或 <code>NBT</code>。</li></ul><p><code>Codec</code> 的本质是定义一套完整的、双向的映射规则，用来规定一个 <code>Java</code> 对象是如何被序列化（保存）为 <code>Json</code>，以及一个 <code>Json</code> 文件是如何被反序列化（加载）成一个 <code>Java</code> 对象。</p><h3 id="_1-2-工作流程" tabindex="-1"><a class="header-anchor" href="#_1-2-工作流程"><span>1.2 工作流程</span></a></h3><p><code>Codec</code> 的的工作包含两个方向：</p><p>1、编码 / 序列化：</p><ul><li>方向：<code>Java 对象</code> -&gt; 某种 <code>数据格式 (JSON/NBT)</code></li><li>用途：当你需要将游戏中的一个对象保存到玩家的硬盘（如世界存档）或通过网络发送给客户端时。</li></ul><p>2、解码 / 反序列化：</p><ul><li>方向：某种 <code>数据格式 (JSON/NBT)</code> -&gt; <code>Java 对象</code></li><li>用途：当游戏启动或加载资源时，从数据包的 JSON 文件或世界存档的 NBT 中读取数据，并将其转换为游戏逻辑可以使用的对象。</li></ul><h3 id="_1-3-为什么我们要使用-codec" tabindex="-1"><a class="header-anchor" href="#_1-3-为什么我们要使用-codec"><span>1.3 为什么我们要使用 Codec？</span></a></h3><p>在处理数据序列化，特别是 JSON 或 NBT 这类格式时，开发者可能会考虑直接使用如 GSON、Jackson 这样的库，或者手动遍历数据结构进行解析和构建。然而，Minecraft 的 Codec 系统提供了超越这些基本功能的诸多优势，使其成为在 Minecraft 模组开发中更推荐的选择：</p><ul><li><strong>类型安全</strong>: Codec 强制在编译时就定义数据结构和 Java 类型之间的映射。这大大减少了因类型不匹配或数据格式错误导致的运行时错误。手动解析 JSON 时，很容易因忘记检查字段是否存在、类型是否正确而引入 bug。</li><li><strong>强大的错误处理</strong>: Codec 的核心是 <code>DataResult</code>，它提供了一种优雅的方式来处理解析过程中可能出现的成功、失败以及部分成功的情况。相比手动解析中繁琐的 <code>try-catch</code> 和空值检查，<code>DataResult</code> 使得错误处理逻辑更清晰、更集中，并且能提供更具上下文的错误信息。</li><li><strong>双向转换</strong>: 一个 Codec 定义了从 Java 对象到序列化形式（编码）以及从序列化形式到 Java 对象（解码）的双向逻辑。这意味着你只需要定义一次数据结构，就可以同时用于读取和写入，减少了代码冗余和潜在的不一致性。手动处理时，编码和解码逻辑往往是分开实现的。</li><li><strong>与游戏数据格式的无缝集成</strong>: Codec 通过 <code>DynamicOps</code> (如 <code>JsonOps</code>, <code>NbtOps</code>) 的抽象，使得同一套 Codec 定义可以轻松应用于 JSON、NBT 等多种 Minecraft 常用的数据格式，而无需为每种格式重写解析逻辑。</li><li><strong>可组合性与可重用性</strong>: Codec 可以像积木一样组合起来。基础类型的 Codec 可以用来构建复杂对象的 Codec (通过 <code>RecordCodecBuilder</code>)，列表的 Codec，映射的 Codec 等。这种声明式的方式使得复杂数据结构的定义更为简洁和模块化。</li><li><strong>数据演进与版本控制</strong>: 作为 DataFixerUpper (DFU) 库的一部分，Codec 的设计初衷就包含了对数据版本迁移的考量。虽然模组开发者可能不直接使用完整的 DFU 框架，但 Codec 本身的设计理念鼓励思考数据的长期演进，并提供了一些机制（如 <code>optionalFieldOf</code>、<code>xmap</code> 的变体）来处理数据结构的变化。</li><li><strong>与 Minecraft 核心系统的兼容性</strong>: Minecraft 的许多核心系统，如数据包加载、配方、世界生成、数据组件等，都深度依赖 Codec。使用 Codec 可以确保你的自定义数据与这些系统更好地集成，并能利用游戏提供的验证和加载机制。 虽然对于非常简单、一次性的 JSON 解析任务，手动处理或使用通用库可能看起来更直接，但一旦涉及到需要持久化、网络同步、与游戏系统交互或未来可能需要演进的复杂数据结构，Codec 所提供的结构化、类型安全和错误处理能力将带来巨大的开发效率和代码质量提升。</li></ul><h2 id="_2-codec-工具包-关键类与接口" tabindex="-1"><a class="header-anchor" href="#_2-codec-工具包-关键类与接口"><span>2 Codec 工具包：关键类与接口</span></a></h2><p>Codec 系统由一系列协同工作的类和接口组成，它们共同构成了 Minecraft 数据序列化的基石。</p><h3 id="_2-1-codec-a-双向转换器" tabindex="-1"><a class="header-anchor" href="#_2-1-codec-a-双向转换器"><span>2.1 <code>Codec&lt;A&gt;</code>：双向转换器</span></a></h3><p><code>Codec&lt;A&gt;</code> 接口定义了一个针对特定类型 <code>A</code> 的对象的双向转换逻辑，该逻辑能够普适于任何层级化的序列化格式。它实质上结合了一个 <code>Encoder&lt;A&gt;</code>（编码器）和一个 <code>Decoder&lt;A&gt;</code>（解码器）的功能。Codec 的实例被设计为不可变的，并且一旦构建完成，通常建议将其存储在静态（static final）字段中，以便复用和确保线程安全。</p><h3 id="_2-2-dynamicops-t-适配数据格式-jsonops-nbtops" tabindex="-1"><a class="header-anchor" href="#_2-2-dynamicops-t-适配数据格式-jsonops-nbtops"><span>2.2 <code>DynamicOps&lt;T&gt;</code>：适配数据格式 (JsonOps, NbtOps)</span></a></h3><p><code>DynamicOps&lt;T&gt;</code> 扮演着层级化序列化格式（例如 JSON、NBT）的适配器角色。它允许从底层序列化形式中提取和插入简单数据类型。常见的实现有用于处理 JSON 数据的 <code>JsonOps</code> 和用于处理 NBT 数据的 <code>NbtOps</code>。Codec 通常与一个 <code>DynamicOps</code> 实例协同工作，以完成实际的编解码操作。</p><div class="vp-image-card" style="" data-v-b341e6c7><div class="image-container" data-v-b341e6c7><img src="/images/DynamicOps.png" alt="各种DynamicOps实现" loading="lazy" data-v-b341e6c7><div class="image-info" data-v-b341e6c7><h3 class="title" data-v-b341e6c7><span data-v-b341e6c7>各种DynamicOps实现</span></h3><!----><!----></div></div></div><h3 id="_2-3-dataresult-a-处理结果与错误" tabindex="-1"><a class="header-anchor" href="#_2-3-dataresult-a-处理结果与错误"><span>2.3 <code>DataResult&lt;A&gt;</code>：处理结果与错误</span></a></h3><p>使用 <code>Codec</code> 进行编码或解码操作后，返回的是一个 <code>DataResult&lt;A&gt;</code> 对象。该对象封装了转换操作的结果，其中可能包含成功转换的实例，或者在转换失败时包含错误数据。<code>DataResult</code> 可以表示成功或失败状态，其 <code>resultOrPartial</code> 方法在处理自定义数据包（datapack）资源等场景时特别有用，它允许在记录错误的同时，仍可能获取部分成功转换的结果。</p><h2 id="_3-如何构建-codec" tabindex="-1"><a class="header-anchor" href="#_3-如何构建-codec"><span>3 如何构建 Codec</span></a></h2><p>构建复杂的 Codec 通常始于对基本数据类型和常见集合类型的处理。</p><h3 id="_3-1-基本类型的-codec-string-int-bool-等" tabindex="-1"><a class="header-anchor" href="#_3-1-基本类型的-codec-string-int-bool-等"><span>3.1 基本类型的 Codec (String, Int, Bool 等)</span></a></h3><p>Mojang 提供了用于处理 Java 基本数据类型及其包装类的内置 Codec，例如 <code>Codec.BOOL</code>、<code>Codec.INT</code>、<code>Codec.STRING</code>、<code>Codec.FLOAT</code> 等。这些是构建更复杂 Codec 的基础构件。</p><p>因为本篇教程我是基于Neoforge开发角度，所以你可以在Neoforge官方的<a href="https://docs.neoforged.net/docs/datastorage/codecs/#existing-codecs" target="_blank" rel="noopener noreferrer">Wiki</a>中找到更多的Codec类型。</p><h3 id="_3-2-使用-recordcodecbuilder-定义复杂数据" tabindex="-1"><a class="header-anchor" href="#_3-2-使用-recordcodecbuilder-定义复杂数据"><span>3.2 使用 <code>RecordCodecBuilder</code> 定义复杂数据</span></a></h3><p>对于具有明确命名字段的自定义类或 Java 记录（Record），<code>RecordCodecBuilder</code> 是创建其 Codec 的主要工具。</p><h4 id="_3-2-1-构建自定义对象和记录的结构" tabindex="-1"><a class="header-anchor" href="#_3-2-1-构建自定义对象和记录的结构"><span>3.2.1 构建自定义对象和记录的结构</span></a></h4><p><code>RecordCodecBuilder</code> 是为具有显式命名字段的类或 Java Record 创建 Codec 的核心工具。它允许通过 <code>instance.group(...)</code> 方法定义多个字段。Java Record 因其固有的不可变性和简洁性而特别适合与 <code>RecordCodecBuilder</code> 配合使用。</p><h4 id="_3-2-2-定义字段-fieldof-与-forgetter" tabindex="-1"><a class="header-anchor" href="#_3-2-2-定义字段-fieldof-与-forgetter"><span>3.2.2 定义字段：<code>fieldOf()</code> 与 <code>forGetter()</code></span></a></h4><p>在 <code>RecordCodecBuilder.group(...)</code>内部，每个字段都通过其类型的 <code>Codec</code>、后跟 <code>.fieldOf(&quot;json_key_name&quot;)</code>（指定序列化格式中的键名）以及 <code>.forGetter(MyClass::getFieldName)</code>（提供用于序列化的 getter 函数）来定义。这些方法将 Java 字段（通过其 getter 和类型的 Codec）与其在序列化数据中的表示（键名）关联起来。</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 假设有一个 Java Record:</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// public record MyData(String name, int value) {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// MyData 的 Codec</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> static</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> final</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Codec</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> MY_DATA_CODEC</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> RecordCodecBuilder</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">create</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">instance </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    instance</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">group</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        Codec</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">STRING</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">fieldOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">name</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">forGetter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">MyData</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">),</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        Codec</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">INT</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">fieldOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">value</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">forGetter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">MyData</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">value</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apply</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">instance</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> MyData</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">::new</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span></code></pre></div><h4 id="_3-2-3-处理可选性-optionalfieldof-与默认值" tabindex="-1"><a class="header-anchor" href="#_3-2-3-处理可选性-optionalfieldof-与默认值"><span>3.2.3 处理可选性：optionalFieldOf() 与默认值</span></a></h4><p>为了处理数据中可能缺失的字段，可以使用 <code>someCodec.optionalFieldOf(&quot;field_name&quot;)</code> 来创建一个对应 <code>Optional&lt;Type&gt;</code> 类型的字段。如果希望在字段缺失时提供一个默认值，则可以使用 <code>someCodec.optionalFieldOf(&quot;field_name&quot;, defaultValue)</code>。需要注意的是，如果一个可选字段存在但数据格式错误，错误可能会被静默捕获，并使用默认值代替。若希望在可选元素解析出错时消费掉该错误，可以使用 <code>lenientOptionalFieldOf</code>。</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 假设有一个 Java Record:</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// public record ConfigData(String id, Optional description, int timeout) {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// ConfigData 的 Codec</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> static</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> final</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Codec</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> CONFIG_DATA_CODEC</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> RecordCodecBuilder</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">create</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">instance </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    instance</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">group</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        Codec</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">STRING</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">fieldOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">id</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">forGetter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ConfigData</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">id</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">),</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        Codec</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">STRING</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">optionalFieldOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">description</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">forGetter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ConfigData</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">description</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">),</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 返回 Optional</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        Codec</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">INT</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">optionalFieldOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">timeout</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 30</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">forGetter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ConfigData</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">timeout</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 如果缺失，timeout 默认为 30</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apply</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">instance</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ConfigData</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">::new</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span></code></pre></div><h3 id="_3-3-转换与组合-codec" tabindex="-1"><a class="header-anchor" href="#_3-3-转换与组合-codec"><span>3.3 转换与组合 Codec</span></a></h3><p>Codec 系统提供了强大的机制来转换现有 Codec 以适应新的数据类型，或将多个 Codec 组合成更复杂的结构。</p><h4 id="_3-3-1-类型间映射-xmap-及其变体-flatxmap-comapflatmap" tabindex="-1"><a class="header-anchor" href="#_3-3-1-类型间映射-xmap-及其变体-flatxmap-comapflatmap"><span>3.3.1 类型间映射：xmap() 及其变体 (flatXMap, comapFlatMap)</span></a></h4><p>WIP</p><h4 id="_3-3-2-实现多态分发-codec-dispatch" tabindex="-1"><a class="header-anchor" href="#_3-3-2-实现多态分发-codec-dispatch"><span>3.3.2 实现多态分发：Codec.dispatch()</span></a></h4><p>WIP</p><h4 id="_3-3-3-组合-codec-codec-pair-与-codec-either" tabindex="-1"><a class="header-anchor" href="#_3-3-3-组合-codec-codec-pair-与-codec-either"><span>3.3.3 组合 Codec：Codec.pair() 与 Codec.either()</span></a></h4><p>WIP</p><h2 id="_4-codec-在minecraft-neoforge、fabric-生态中的应用" tabindex="-1"><a class="header-anchor" href="#_4-codec-在minecraft-neoforge、fabric-生态中的应用"><span>4 Codec 在Minecraft （Neoforge、Fabric） 生态中的应用</span></a></h2><p>随着 Minecraft 版本的迭代，Codec 的应用范围不断扩大，深入到模组开发的各个方面。</p><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><!--[--><button class="active vp-tab-nav" type="button" role="tab" aria-controls="tab-211-0" aria-selected="true"><!--[-->数据组件<!--]--></button><button class="vp-tab-nav" type="button" role="tab" aria-controls="tab-211-1" aria-selected="false"><!--[-->自定义配方序列化器<!--]--></button><button class="vp-tab-nav" type="button" role="tab" aria-controls="tab-211-2" aria-selected="false"><!--[-->网络数据包序列化<!--]--></button><!--]--></div><!--[--><div id="tab-211-0" class="active vp-tab" role="tabpanel" aria-expanded="true"><div class="vp-tab-title"><!--[-->数据组件<!--]--></div><!--[--><p>数据组件（Data Components）是 Minecraft 1.20.5 版本引入的一项重要特性，用以替代旧的 <code>ItemStack NBT</code> 系统来存储物品栈的附加数据。Codec 在定义这些自定义数据组件的持久化和网络同步方式方面起着核心作用。</p><p>对于 NeoForge，数据组件将数据作为实际对象存储在物品栈上。定义一个 <code>DataComponentType</code> 时，需要为其提供一个用于持久化的 Codec（通过 <code>.persistent()</code> 方法指定）和/或一个用于网络同步的 <code>StreamCodec</code>（通过 <code>.networkSynchronized()</code> 方法指定）。<code>RecordCodecBuilder</code> 是创建这些 Codec 的常用工具。</p><!--]--></div><div id="tab-211-1" class="vp-tab" role="tabpanel" aria-expanded="false"><div class="vp-tab-title"><!--[-->自定义配方序列化器<!--]--></div><!--[--><p>模组可以通过自定义配方序列化器（Recipe Serializer）来定义全新的合成机制或处理类型，这些通常具有自定义的 JSON 结构。Codec 在此过程中负责解析这些 JSON 并将其转换为游戏逻辑中可用的 Java 对象。</p><p>对于 NeoForge，自定义的 <code>RecipeSerializer</code> 需要提供一个 <code>MapCodec</code> 用于 JSON 的序列化和反序列化，以及一个 <code>StreamCodec</code> 用于网络同步。通常使用 <code>RecordCodecBuilder.mapCodec(...)</code> 来创建所需的 MapCodec。</p><!--]--></div><div id="tab-211-2" class="vp-tab" role="tabpanel" aria-expanded="false"><div class="vp-tab-title"><!--[-->网络数据包序列化<!--]--></div><!--[--><p>为了实现高效的网络通信，Minecraft 使用 <code>StreamCodec&lt;B, V&gt;</code>（其中 B 通常是 ByteBuf 或 RegistryFriendlyByteBuf）进行数据包内容的序列化和反序列化。它与用于磁盘/JSON 序列化的通用 <code>Codec&lt;T&gt;</code> 是不同的。<code>DataComponentType.Builder</code> 接受一个 <code>StreamCodec</code> 用于 <code>networkSynchronized</code> 配置。<code>RecipeSerializer</code> 同样需要一个 <code>StreamCodec</code>。</p><!--]--></div><!--]--></div></div><!--[--><h2 id="doc-contributors" tabindex="-1"><a href="#doc-contributors" class="header-anchor"><span>贡献者</span></a></h2><div class="vp-contributors"><a href="https://github.com/QiHuang02" target="_blank" rel="noreferrer" class="vp-contributor"><img src="https://avatars.githubusercontent.com/QiHuang02?v=4" alt class="vp-contributor-avatar"><span class="vp-contributor-name">QiHuang02</span></a></div><!--]--><!--[--><h2 id="doc-changelog" tabindex="-1"><a href="#doc-changelog" class="header-anchor"><span>更新日志</span></a></h2><div class="vp-changelog-wrapper"><div class="vp-changelog-header"><div class="vp-latest-updated"><span class="vp-changelog-icon"></span><span data-allow-mismatch>2025/5/25 11:00</span></div><div><span class="vp-changelog-menu-icon"></span><span>查看所有更新日志</span></div></div><ul class="vp-changelog-list"><!--[--><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/QiHuang02/qihuang02.github.io/commit/49475ec0a535726de79594368456e79b3bafa680" target="_blank" rel="noreferrer"><code>49475</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">docs(minecraft): 详细阐述 Codec 在 Minecraft 模组开发中的优势</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-05-25T11:00:54.000Z">2025/5/25</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/QiHuang02/qihuang02.github.io/commit/3d299b3141239f3a4d045ae2515439d0b763b489" target="_blank" rel="noreferrer"><code>3d299</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">docs(notes): 更新 Codec 教程</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-05-25T10:44:15.000Z">2025/5/25</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/QiHuang02/qihuang02.github.io/commit/b7a7fb47c0cae20ef4ab1f93d47418ee4d94cab8" target="_blank" rel="noreferrer"><code>b7a7f</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">docs(notes): 添加 Codec 相关文档</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-05-25T00:42:40.000Z">2025/5/25</time></span></li><!--]--></ul></div><!--]--><!----></div></main><footer class="vp-doc-footer" data-v-fc326dca data-v-9cea32a4><!--[--><!--]--><div class="edit-info" data-v-9cea32a4><div class="edit-link" data-v-9cea32a4><a class="vp-link link no-icon edit-link-button" href="https://github.com/QiHuang02/qihuang02.github.io/edit/master/docs/notes/minecraft/misc/Codec.md" target="_blank" rel="noreferrer" data-v-9cea32a4><!--[--><span class="vpi-square-pen edit-link-icon" aria-label="edit icon" data-v-9cea32a4></span> 帮助我修改错误<!--]--><!----></a></div><!----></div><!----><nav class="prev-next" data-v-9cea32a4><div class="pager" data-v-9cea32a4><a class="vp-link link pager-link prev" href="/notes/minecraft/misc/blockbench/" data-v-9cea32a4><!--[--><span class="desc" data-v-9cea32a4>上一页</span><span class="title" data-v-9cea32a4>Blockbench</span><!--]--><!----></a></div><div class="pager" data-v-9cea32a4><a class="vp-link link pager-link next" href="/notes/minecraft/misc/data_components/" data-v-9cea32a4><!--[--><span class="desc" data-v-9cea32a4>下一页</span><span class="title" data-v-9cea32a4>DataComponents</span><!--]--><!----></a></div></nav></footer><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:block;" data-v-fc326dca><div style="display: flex;align-items: center;justify-content: center;height: 96px"><span style="--loading-icon: url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; preserveAspectRatio=&#39;xMidYMid&#39; viewBox=&#39;25 25 50 50&#39;%3E%3CanimateTransform attributeName=&#39;transform&#39; type=&#39;rotate&#39; dur=&#39;2s&#39; keyTimes=&#39;0;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;360&#39;%3E%3C/animateTransform%3E%3Ccircle cx=&#39;50&#39; cy=&#39;50&#39; r=&#39;20&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39; stroke-width=&#39;4&#39; stroke-linecap=&#39;round&#39;%3E%3Canimate attributeName=&#39;stroke-dasharray&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;1,200;90,200;1,200&#39;%3E%3C/animate%3E%3Canimate attributeName=&#39;stroke-dashoffset&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;-35px;-125px&#39;%3E%3C/animate%3E%3C/circle%3E%3C/svg%3E&quot;);--icon-size: 48px;display: inline-block;width: var(--icon-size);height: var(--icon-size);background-color: currentcolor;-webkit-mask-image: var(--loading-icon);mask-image: var(--loading-icon)"></span></div></div><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-4371dc7a data-v-71b1b143><span class="percent" data-allow-mismatch data-v-71b1b143>0%</span><span class="show icon vpi-back-to-top" data-v-71b1b143></span><svg aria-hidden="true" data-v-71b1b143><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-71b1b143></circle></svg></button><footer class="vp-footer has-sidebar" vp-footer data-v-4371dc7a data-v-78b963e9><!--[--><div class="container" data-v-78b963e9><p class="message" data-v-78b963e9><a target="_blank" href="/">𝓔𝔁𝓹𝓮𝓻𝓲𝓮𝓷𝓬𝓮 𝓲𝓼 𝓽𝓱𝓮 𝓫𝓮𝓼𝓽 𝓽𝓮𝓪𝓬𝓱𝓮𝓻.</a> - Powered by <a target="_blank" href="https://v2.vuepress.vuejs.org/">VuePress</a> & <a target="_blank" href="https://theme-plume.vuejs.press">vuepress-theme-plume</a></p><p class="copyright" data-v-78b963e9>Copyright © 2024 - QiHuang02</p></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-08d28jb5.js" defer></script></body></html>